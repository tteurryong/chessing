<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>로또 뽑기</title>
<style>
  body { background:#222; color:white; font-family:sans-serif; text-align:center; }
  canvas { background:#333; display:block; margin:10px auto; image-rendering:pixelated; }
  button {
    background:#ffcc00; border:none; padding:10px 20px; font-size:20px; font-weight:bold;
    cursor:pointer; border-radius:8px;
  }
  button:hover { background:#ffaa00; }
  #results { margin-top:20px; font-size:18px; }
</style>
</head>
<body>

<h1>🎯 로또 뽑기</h1>
<canvas id="lottoCanvas" width="500" height="300"></canvas>
<button id="drawBtn">뽑기</button>
<div id="results"></div>

<script>
const canvas = document.getElementById("lottoCanvas");
const ctx = canvas.getContext("2d");

let balls = [];
let pickedNumbers = [];
let resultsLog = [];

// 공 초기화 함수
function initBalls() {
  balls = [];
  for (let i = 1; i <= 45; i++) {
    balls.push({
      num: i,
      x: Math.random() * (canvas.width - 20) + 10,
      y: Math.random() * (canvas.height - 20) + 10,
      vx: (Math.random() - 0.5) * 4,
      vy: (Math.random() - 0.5) * 4,
      color: `hsl(${i*8}, 80%, 50%)`
    });
  }
}

// 공 그리기
function drawBalls() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  balls.forEach(b => {
    ctx.fillStyle = b.color;
    ctx.beginPath();
    ctx.arc(b.x, b.y, 10, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = "white";
    ctx.font = "10px sans-serif";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText(b.num, b.x, b.y);
  });
}

// 공 움직이기
function updateBalls() {
  balls.forEach(b => {
    b.x += b.vx;
    b.y += b.vy;

    if (b.x <= 10 || b.x >= canvas.width - 10) b.vx *= -1;
    if (b.y <= 10 || b.y >= canvas.height - 10) b.vy *= -1;
  });
}

// 번호 뽑기
function pickNumbers() {
  let numbers = [];
  let tempBalls = [...balls];
  while (numbers.length < 6) {
    let index = Math.floor(Math.random() * tempBalls.length);
    numbers.push(tempBalls[index].num);
    tempBalls.splice(index, 1);
  }
  numbers.sort((a,b) => a - b);
  return numbers;
}

let isDrawing = false;
document.getElementById("drawBtn").addEventListener("click", () => {
  if (isDrawing) return;
  isDrawing = true;
  let time = 2000; // 2초 동안 공 튀기기
  let startTime = Date.now();
  let anim = setInterval(() => {
    updateBalls();
    drawBalls();
    if (Date.now() - startTime >= time) {
      clearInterval(anim);
      let nums = pickNumbers();
      resultsLog.push(nums);
      document.getElementById("results").innerHTML = resultsLog
        .map((set, idx) => `<div>세트 ${idx+1}: ${set.join(", ")}</div>`)
        .join("");
      initBalls();
      isDrawing = false;
    }
  }, 30);
});

// 초기 실행
initBalls();
setInterval(() => {
  if (!isDrawing) {
    updateBalls();
    drawBalls();
  }
}, 30);
</script>
</body>
</html>
